smartNameRemoval causing compiler crash
What steps will reproduce the problem? Compiler the following code in advanced mode:    {{{  var goog = {};  goog.inherits = function(x, y) {};  var ns = {};  /** @constructor */ ns.PageSelectionModel = function(){};    /** @constructor */   ns.PageSelectionModel.FooEvent = function() {};  /** @constructor */   ns.PageSelectionModel.SelectEvent = function() {};  goog.inherits(ns.PageSelectionModel.ChangeEvent, ns.PageSelectionModel.FooEvent);  }}}      What is the expected output? What do you see instead? The compiler will crash. The last var check throws an illegal state exception because it knows something is wrong.    The crash is caused by smartNameRemoval. It has special logic for counting references in class-defining function calls (like goog.inherits), and it isn't properly creating a reference to PageSelectionModel.